<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Toronto Transit Live</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Draggable.min.js"></script>
    <link rel="stylesheet" href="desktop.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanta/0.5.24/vanta.net.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RHC8SYEC4C"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-RHC8SYEC4C');
    </script>
</head>

<body>
    <!-- Vanta.js Animated Background -->
    <div id="vanta-bg"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; opacity: 0.25;">
    </div>

    <!-- MAP VIEWPORT (Full Screen) -->
    <div id="viewport">
        <svg id="ttc-svg" viewBox="-200 0 1400 800" preserveAspectRatio="xMidYMid meet">
            <g id="map-root">
                <g id="tracks-layer"></g>
                <g id="alerts-layer"></g>
                <g id="stations-layer"></g>
            </g>
        </svg>
    </div>

    <!-- Subway Closed Overlay -->
    <div id="closed-overlay" class="closed-overlay hidden">
        <div class="closed-content">
            <i class="fas fa-moon closed-icon"></i>
            <h2 class="closed-title">Subway Closed</h2>
            <p class="closed-subtitle">Service resumes at <span id="reopen-time">6:00 AM</span></p>
            <div class="closed-divider"></div>
            <p class="closed-note">The subway is closed at this time</p>
            <div class="closed-hours">
                <div class="hours-title"><i class="fas fa-clock"></i> Daily Operating Hours</div>
                <div class="hours-row">
                    <span class="hours-day">Mon - Sat</span>
                    <span class="hours-time">6:00 AM – 2:00 AM</span>
                </div>
                <div class="hours-row">
                    <span class="hours-day">Sunday</span>
                    <span class="hours-time">8:00 AM – 2:00 AM</span>
                </div>
            </div>
        </div>
    </div>

    <!-- FLOATING UI LAYER -->
    <div class="ui-layer">
        <!-- Top Bar -->
        <div class="top-bar">
            <!-- Left Side FABs -->
            <div class="fab-stack left">
                <!-- Hamburger Menu Button -->
                <div class="fab" id="btn-menu">
                    <i class="fas fa-bars"></i>
                </div>
                <!-- Theme Toggle Button -->
                <div class="fab" id="btn-theme">
                    <i class="fas fa-moon"></i>
                </div>
            </div>

            <!-- Right Side FABs -->
            <div class="fab-stack">
                <div class="fab" id="btn-recenter"><i class="fas fa-crosshairs"></i></div>
                <div class="fab" id="btn-legend">
                    <i class="fas fa-layer-group"></i>
                </div>
                <div class="fab" id="btn-info-desktop">
                    <i class="fas fa-info-circle"></i>
                </div>
            </div>
        </div>

        <!-- Top Center Clock & Status -->
        <div class="top-center-info">
            <!-- Clock Display -->
            <div id="clock-display" class="header-clock">
                <div class="clock-time">--:--</div>
                <div class="clock-date">---, --- --</div>
            </div>
            <!-- Status Indicator -->
            <div id="status-indicator" class="status-indicator loading">
                <div class="status-spinner"></div>
                <i class="fas fa-eye status-eye"></i>
                <span class="status-text">Loading</span>
                <div class="live-dot"></div>
            </div>
        </div>
    </div>

    <!-- Slide-out Menu Panel (Outside ui-layer for proper pointer-events) -->
    <div id="menu-panel" class="menu-panel hidden">
        <div class="menu-header">
            <i class="fas fa-subway" style="color: var(--l1-color); font-size: 20px;"></i>
            <span>TORONTO TRANSIT LIVE</span>
        </div>
        <div class="menu-nav">
            <div class="menu-item active" data-tab="lines">
                <i class="fas fa-route"></i>
                <span>Map</span>
            </div>
            <div class="menu-item" data-tab="alerts">
                <i class="fas fa-exclamation-triangle"></i>
                <span>Alerts</span>
                <span id="alerts-badge" class="menu-badge hidden">0</span>
            </div>
            <div class="menu-item" data-tab="upcoming">
                <i class="fas fa-clock"></i>
                <span>Upcoming</span>
                <span id="upcoming-badge" class="menu-badge hidden">0</span>
            </div>
            <div class="menu-item" data-tab="about">
                <i class="fas fa-info-circle"></i>
                <span>About</span>
            </div>
        </div>
        <div class="menu-footer">
            v1.2.0 Alpha • Made by Faiz P
        </div>
    </div>

    <!-- Legend Popup -->
    <div id="legend-popup" class="legend-popup hidden">
        <div class="legend-popup-title">Layers</div>
        <div class="legend-item active" data-filter="suspension">
            <i class="fas fa-eye toggle-icon"></i>
            <svg width="32" height="8" style="overflow: visible;">
                <path d="M 0 4 L 32 4" class="alert-base pulse-solid"
                    style="stroke-width: 6; opacity: 1; stroke-linecap: round;"></path>
            </svg>
            <span>No Service</span>
        </div>
        <div class="legend-item active" data-filter="delay">
            <i class="fas fa-eye toggle-icon"></i>
            <svg width="32" height="8" style="overflow: visible;">
                <path d="M 0 4 L 32 4" class="alert-base delay pulse-solid"
                    style="stroke-width: 6; opacity: 1; stroke-linecap: round;"></path>
            </svg>
            <span>Delays / Slow</span>
        </div>
        <div class="legend-item active" data-filter="shuttle">
            <i class="fas fa-eye toggle-icon"></i>
            <svg width="32" height="8" style="overflow: visible;">
                <path d="M 0 4 L 32 4" class="shuttle-outline"
                    style="stroke-width: 3; opacity: 0.9; stroke-linecap: round;"></path>
            </svg>
            <span>Shuttle Buses</span>
        </div>
    </div>

    <!-- Info Popup (Walkthrough) -->
    <div id="info-popup-desktop" class="legend-popup hidden" style="right: 16px; top: 200px;">
        <div class="legend-popup-title">Toronto Transit Live <span
                style="font-size: 10px; opacity: 0.6; font-weight: 400; margin-left: 4px; background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 4px;">ALPHA</span>
        </div>

        <!-- What is this app section -->
        <div class="walkthrough-section">
            <div class="walkthrough-title"><i class="fas fa-subway" style="color: var(--l1-color);"></i> What is this
                app?</div>
            <p class="walkthrough-text">
                A real-time visualization of TTC subway alerts, outages, and delays on an interactive map.
                See exactly where disruptions are happening on the network.
            </p>
        </div>

        <!-- How to use section -->
        <div class="walkthrough-section">
            <div class="walkthrough-title"><i class="fas fa-hand-pointer" style="color: var(--l2-color);"></i> How to
                use</div>
            <ul class="walkthrough-list">
                <li><strong>Map:</strong> Drag and scroll to explore the subway lines</li>
                <li><strong>Red zones:</strong> Show current service suspensions</li>
                <li><strong>Orange zones:</strong> Show delays or slow service</li>
                <li><strong>Menu:</strong> Access Alerts & Upcoming panels</li>
                <li><strong>Layers:</strong> Toggle alert types visibility</li>
            </ul>
        </div>

        <!-- Disclaimer section -->
        <div class="walkthrough-section"
            style="background: rgba(255, 183, 0, 0.1); border-radius: 8px; padding: 10px; margin-top: 8px;">
            <div class="walkthrough-title" style="font-size: 12px;"><i class="fas fa-exclamation-triangle"
                    style="color: var(--l1-color);"></i> Disclaimer</div>
            <p class="walkthrough-text" style="font-size: 11px; margin-top: 4px;">
                This is a personal project, not an official TTC app. Data may be delayed or inaccurate. Always verify
                with official TTC sources.
            </p>
        </div>

        <div class="info-popup-footer">
            Made by Faiz P • v1.2.0
        </div>
    </div>

    <!-- Alerts Panel -->
    <div id="alerts-panel" class="content-panel">
        <div class="panel-header">
            <h2><i class="fas fa-exclamation-triangle"></i> Active Service Alerts</h2>
            <button class="close-panel-btn" data-close="alerts"><i class="fas fa-times"></i></button>
        </div>
        <div class="line-filter" id="alerts-filter">
            <button class="filter-btn active" data-line="all">All</button>
            <button class="filter-btn bg-l1" data-line="1">1</button>
            <button class="filter-btn bg-l2" data-line="2">2</button>
            <button class="filter-btn bg-l4" data-line="4">4</button>
            <button class="filter-btn bg-l5" data-line="5"><i class="fas fa-hard-hat"
                    style="margin-right: 4px; font-size: 10px;"></i>5</button>
            <button class="filter-btn bg-l6" data-line="6">6</button>
        </div>
        <div id="alerts-list" class="panel-content"></div>
    </div>

    <!-- Upcoming Outages Panel -->
    <div id="upcoming-panel" class="content-panel">
        <div class="panel-header">
            <h2><i class="fas fa-clock"></i> Upcoming Service Changes</h2>
            <button class="close-panel-btn" data-close="upcoming"><i class="fas fa-times"></i></button>
        </div>
        <div id="upcoming-list" class="panel-content"></div>
    </div>

    <!-- About Panel -->
    <div id="about-panel" class="content-panel">
        <div class="panel-header">
            <h2><i class="fas fa-info-circle"></i> About</h2>
            <button class="close-panel-btn" data-close="about"><i class="fas fa-times"></i></button>
        </div>
        <div class="panel-content">
            <div class="about-content">
                <h3 style="color: var(--l1-color); margin-bottom: 16px;">
                    <i class="fas fa-exclamation-triangle"></i> Disclaimer
                </h3>
                <p>
                    This is a <strong>personal project</strong> and not an official TTC map. There could be
                    mistakes in the data or representation. This app is not affiliated with the Toronto Transit
                    Commission (TTC).
                </p>
                <p style="margin-top: 16px;">
                    <strong>Why I made this:</strong><br>
                    I made this dashboard because I was not able to easily know if a subway outage would affect
                    my commute. I always had to look up a map to cross-reference alerts. This tool makes it
                    easier to verify if I am affected.
                </p>
                <div
                    style="margin-top: 24px; padding-top: 16px; border-top: 1px solid var(--border-color); font-size: 13px; color: var(--text-muted);">
                    Data provided by TTC Open Data.
                </div>
            </div>
        </div>
    </div>

    <!-- Menu Overlay -->
    <div id="menu-overlay" class="menu-overlay hidden"></div>

    <!-- Disclaimer Banner -->
    <div id="disclaimer-banner" class="disclaimer-banner">
        <div class="disclaimer-content">
            <i class="fas fa-exclamation-triangle" style="color: #FFB700; margin-right: 12px; font-size: 16px;"></i>
            <span>This is a personal project. Data may be inaccurate. Not affiliated with the TTC. <strong
                    style="color: var(--l1-color);">Click ⓘ to learn more.</strong></span>
        </div>
        <button id="btn-accept-disclaimer">I Understand</button>
    </div>

    <script src="desktop.js?v=1768190900"></script>
</body>

</html>